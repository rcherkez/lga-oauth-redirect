<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LGA Employee OAuth Response</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 2rem;
            border-radius: 1rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }
        .logo {
            font-size: 3rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        .title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            font-weight: 600;
            text-align: center;
        }
        .response-section {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .parameter {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }
        .parameter-name {
            font-weight: bold;
            color: #ffd700;
        }
        .parameter-value {
            color: #90EE90;
            margin-top: 5px;
        }
        .error {
            color: #ff6b6b;
            font-weight: bold;
        }
        .success {
            color: #51cf66;
            font-weight: bold;
        }
        .warning {
            color: #ffd43b;
            font-weight: bold;
        }
        .redirect-button {
            background: #ffd700;
            color: black;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            text-decoration: none;
            display: inline-block;
        }
        .redirect-button:hover {
            background: #ffed4e;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">ğŸ—ï¸</div>
        <div class="title">Service Fusion OAuth Response</div>
        <div class="message">This page shows the OAuth response from Service Fusion</div>
    </div>

    <!-- OAuth Response Display -->
    <div class="container">
        <h3>ğŸ“¡ OAuth Response Parameters:</h3>
        <div id="oauthParams" class="response-section">
            Loading OAuth parameters...
        </div>
    </div>

    <!-- Full URL Display -->
    <div class="container">
        <h3>ğŸ”— Complete Redirect URL:</h3>
        <div id="fullURL" class="response-section">
            Loading URL...
        </div>
    </div>

    <!-- Debug Info -->
    <div class="container">
        <h3>ğŸ› Debug Information:</h3>
        <div id="debugInfo" class="response-section">
            Loading debug info...
        </div>
    </div>

    <!-- Manual Redirect Options -->
    <div class="container">
        <h3>ğŸ“± Manual Actions:</h3>
        <p>If you want to test the app redirect, use these buttons:</p>
        <a href="#" id="appRedirect" class="redirect-button">Redirect to App (lga://)</a>
        <a href="#" id="testRedirect" class="redirect-button">Test with Sample Data</a>
    </div>

    <script>
        // Get URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');
        const state = urlParams.get('state');
        const error = urlParams.get('error');
        const errorDescription = urlParams.get('error_description');
        
        // Display OAuth parameters
        const oauthParamsDiv = document.getElementById('oauthParams');
        if (error) {
            oauthParamsDiv.innerHTML = `
                <div class="parameter">
                    <div class="parameter-name">âŒ Error:</div>
                    <div class="parameter-value error">${error}</div>
                </div>
                <div class="parameter">
                    <div class="parameter-name">ğŸ“ Error Description:</div>
                    <div class="parameter-value error">${errorDescription || 'No description provided'}</div>
                </div>
            `;
        } else if (code && state) {
            oauthParamsDiv.innerHTML = `
                <div class="parameter">
                    <div class="parameter-name">âœ… Authorization Code:</div>
                    <div class="parameter-value success">${code}</div>
                </div>
                <div class="parameter">
                    <div class="parameter-name">ğŸ”’ State Parameter:</div>
                    <div class="parameter-value success">${state}</div>
                </div>
            `;
        } else {
            oauthParamsDiv.innerHTML = `
                <div class="parameter">
                    <div class="parameter-name">âš ï¸ Missing Parameters:</div>
                    <div class="parameter-value warning">
                        Code: ${code || 'NULL'}
                        State: ${state || 'NULL'}
                    </div>
                </div>
            `;
        }
        
        // Display full URL
        document.getElementById('fullURL').textContent = window.location.href;
        
        // Display debug info
        document.getElementById('debugInfo').textContent = `
URL Components:
- Protocol: ${window.location.protocol}
- Host: ${window.location.host}
- Pathname: ${window.location.pathname}
- Search: ${window.location.search}
- Hash: ${window.location.hash}

Query Parameters:
${Array.from(urlParams.entries()).map(([key, value]) => `${key}: ${value}`).join('\n')}

User Agent: ${navigator.userAgent}
Timestamp: ${new Date().toISOString()}
        `;
        
        // Manual redirect to app
        document.getElementById('appRedirect').addEventListener('click', function(e) {
            e.preventDefault();
            const appURL = `lga://oauth/callback?code=${code || 'test_code'}&state=${state || 'test_state'}`;
            alert(`Attempting to redirect to: ${appURL}`);
            window.location.href = appURL;
        });
        
        // Test redirect with sample data
        document.getElementById('testRedirect').addEventListener('click', function(e) {
            e.preventDefault();
            const testURL = `lga://oauth/callback?code=test_authorization_code_123&state=test_state_456`;
            alert(`Testing redirect with: ${testURL}`);
            window.location.href = testURL;
        });
        
        // Log everything to console
        console.log('ğŸš¨ğŸš¨ğŸš¨ OAuth Response Page Loaded');
        console.log('ğŸš¨ğŸš¨ğŸš¨ Full URL:', window.location.href);
        console.log('ğŸš¨ğŸš¨ğŸš¨ Code:', code);
        console.log('ğŸš¨ğŸš¨ğŸš¨ State:', state);
        console.log('ğŸš¨ğŸš¨ğŸš¨ Error:', error);
        console.log('ğŸš¨ğŸš¨ğŸš¨ Error Description:', errorDescription);
        console.log('ğŸš¨ğŸš¨ğŸš¨ All URL Parameters:', Object.fromEntries(urlParams));
    </script>
</body>
</html>
